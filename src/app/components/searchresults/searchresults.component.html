
<div class="container mt-5">
  <h3>Search results for: <strong>“{{ query }}”</strong></h3>
</div>

<div class="container my-4">
  <div class="row">
    <!-- Filters -->
    <div class="col-md-3">
      <h5>Filter By</h5>
      <form [formGroup]="filterForm">
        <div class="mb-3">
          <label class="form-label">Brand</label>
          <select class="form-select" formControlName="brand">
            <option>All Brands</option>
            <option *ngFor="let b of brands">{{ b }}</option>
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label"><strong>Price Range</strong></label>
          <div class="input-group">
            <span class="input-group-text">$</span>
            <input type="number" class="form-control" formControlName="priceMin" placeholder="Min">
            <span class="input-group-text">-</span>
            <input type="number" class="form-control" formControlName="priceMax" placeholder="Max">
          </div>
        </div>
        <button type="button"
                class="btn btn-outline-primary w-100"
                (click)="applyFilters()">
          Apply
        </button>
      </form>
    </div>

    <!-- Products -->
    <div class="col-md-9">
      <div class="row g-4">
        <ng-container *ngIf="displayedProducts.length; else noResults">
          <div class="col-md-4" *ngFor="let p of displayedProducts">
            <div class="product-card">
              <img [src]="p.imageUrl" alt="{{ p.name }}" class="img-fluid mb-2" />
              <h5>{{ p.name }}</h5>
              <p class="text-success">\${{ p.price.toFixed(2) }}</p>
              <button class="btn btn-primary w-100"
                      (click)="addToCart(p)">
                Add to Cart
              </button>
            </div>
          </div>
        </ng-container>
        <ng-template #noResults>
          <div class="no-results col-12">
            No results found for your search.
          </div>
        </ng-template>
      </div>

      <!-- Pagination -->
      <nav *ngIf="totalPages > 1" class="mt-4" aria-label="Search page navigation">
        <ul class="pagination justify-content-center">
          <li class="page-item" [class.disabled]="currentPage === 1">
            <a class="page-link" (click)="goToPage(currentPage - 1)">«</a>
          </li>
          <li class="page-item"
              *ngFor="let _ of [].constructor(totalPages); let i = index"
              [class.active]="currentPage === i + 1">
            <a class="page-link" (click)="goToPage(i + 1)">{{ i + 1 }}</a>
          </li>
          <li class="page-item" [class.disabled]="currentPage === totalPages">
            <a class="page-link" (click)="goToPage(currentPage + 1)">»</a>
          </li>
        </ul>

        <div class="d-flex justify-content-end mt-2">
          <label class="me-2 mb-0">Show</label>
          <select class="form-select w-auto"
                  (change)="onPageSizeChange($any($event.target).value)">
            <option *ngFor="let s of pageSizes" [value]="s">{{ s }}</option>
          </select>
        </div>
      </nav>
    </div>
  </div>
</div>


